{"ast":null,"code":"import mongoose from \"mongoose\"; // const connection = {};\n// const connectDb = handler => async (req, res) => {\n//   if (connection.isConnected) {\n//     // use exisiting connection\n//     return handler(req, res);\n//   }\n// //   const db = await mongoose.connect(process.env.MONGO_URL, {\n// //     useCreateIndex: true,\n// //     useFindAndModify: false,\n// //     useNewUrlParser: true,\n// //     useUnifiedTopology: true\n// //   });\n// //   connection.isConnected = db.connections[0].readyState;\n// //   console.log(\"test\");\n// //   return handler(req, res);\n// // };\n\nconst connectDb = handler => async (req, res) => {\n  if (mongoose.connections[0].readyState) return handler(req, res); // Using new database connection\n\n  await mongoose.connect(process.env.MONGO_URL, {\n    useNewUrlParser: true,\n    useFindAndModify: false,\n    useCreateIndex: true\n  });\n  return handler(req, res);\n};\n\nexport default connectDb;","map":{"version":3,"sources":["/home/russ/projects/dress-shop/utils/connectDB.js"],"names":["mongoose","connectDb","handler","req","res","connections","readyState","connect","process","env","MONGO_URL","useNewUrlParser","useFindAndModify","useCreateIndex"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB,C,CAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMC,SAAS,GAAGC,OAAO,IAAI,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAC/C,MAAIJ,QAAQ,CAACK,WAAT,CAAqB,CAArB,EAAwBC,UAA5B,EAAwC,OAAOJ,OAAO,CAACC,GAAD,EAAMC,GAAN,CAAd,CADO,CAE/C;;AACA,QAAMJ,QAAQ,CAACO,OAAT,CAAiBC,OAAO,CAACC,GAAR,CAAYC,SAA7B,EAAwC;AAC5CC,IAAAA,eAAe,EAAE,IAD2B;AAE5CC,IAAAA,gBAAgB,EAAE,KAF0B;AAG5CC,IAAAA,cAAc,EAAE;AAH4B,GAAxC,CAAN;AAKA,SAAOX,OAAO,CAACC,GAAD,EAAMC,GAAN,CAAd;AACD,CATD;;AAWA,eAAeH,SAAf","sourcesContent":["import mongoose from \"mongoose\";\n\n// const connection = {};\n\n// const connectDb = handler => async (req, res) => {\n//   if (connection.isConnected) {\n//     // use exisiting connection\n//     return handler(req, res);\n//   }\n// //   const db = await mongoose.connect(process.env.MONGO_URL, {\n// //     useCreateIndex: true,\n// //     useFindAndModify: false,\n// //     useNewUrlParser: true,\n// //     useUnifiedTopology: true\n// //   });\n// //   connection.isConnected = db.connections[0].readyState;\n// //   console.log(\"test\");\n// //   return handler(req, res);\n// // };\n\nconst connectDb = handler => async (req, res) => {\n  if (mongoose.connections[0].readyState) return handler(req, res);\n  // Using new database connection\n  await mongoose.connect(process.env.MONGO_URL, {\n    useNewUrlParser: true,\n    useFindAndModify: false,\n    useCreateIndex: true\n  });\n  return handler(req, res);\n};\n\nexport default connectDb;\n"]},"metadata":{},"sourceType":"module"}