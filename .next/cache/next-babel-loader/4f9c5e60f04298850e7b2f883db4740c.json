{"ast":null,"code":"import Router from 'next/router';\nimport cookie from 'js-cookie';\nimport { parseCookies } from 'nookies'; // handle auto login when created an account, and login\n\nfunction autoLogin(token, location) {\n  cookie.set('token', token);\n  Router.push(location);\n}\n\nfunction redirectUser(ctx, location) {\n  if (ctx.req) {\n    ctx.res.writeHead(302, {\n      Location: location\n    });\n    ctx.res.end();\n  } else {\n    Router.push('location');\n  }\n}\n\nfunction checkToken(ctx) {\n  if (ctx.req) {\n    var _parseCookies = parseCookies(ctx),\n        token = _parseCookies.token;\n\n    if (!token) redirectUser(ctx, '/');\n  } else {}\n}\n\nexport { autoLogin, redirectUser, checkToken };","map":{"version":3,"sources":["/home/russ/projects/dress-shop/utils/auth.js"],"names":["Router","cookie","parseCookies","autoLogin","token","location","set","push","redirectUser","ctx","req","res","writeHead","Location","end","checkToken"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,aAAnB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,SAASC,YAAT,QAA6B,SAA7B,C,CAEA;;AACA,SAASC,SAAT,CAAmBC,KAAnB,EAA0BC,QAA1B,EAAoC;AAClCJ,EAAAA,MAAM,CAACK,GAAP,CAAW,OAAX,EAAoBF,KAApB;AACAJ,EAAAA,MAAM,CAACO,IAAP,CAAYF,QAAZ;AACD;;AAED,SAASG,YAAT,CAAsBC,GAAtB,EAA2BJ,QAA3B,EAAqC;AACnC,MAAII,GAAG,CAACC,GAAR,EAAa;AACXD,IAAAA,GAAG,CAACE,GAAJ,CAAQC,SAAR,CAAkB,GAAlB,EAAuB;AAAEC,MAAAA,QAAQ,EAAER;AAAZ,KAAvB;AACAI,IAAAA,GAAG,CAACE,GAAJ,CAAQG,GAAR;AACD,GAHD,MAGO;AACLd,IAAAA,MAAM,CAACO,IAAP,CAAY,UAAZ;AACD;AACF;;AAED,SAASQ,UAAT,CAAoBN,GAApB,EAAyB;AACvB,MAAIA,GAAG,CAACC,GAAR,EAAa;AAAA,wBACOR,YAAY,CAACO,GAAD,CADnB;AAAA,QACHL,KADG,iBACHA,KADG;;AAEX,QAAI,CAACA,KAAL,EAAYI,YAAY,CAACC,GAAD,EAAM,GAAN,CAAZ;AACb,GAHD,MAGO,CACN;AACF;;AAED,SAASN,SAAT,EAAoBK,YAApB,EAAkCO,UAAlC","sourcesContent":["import Router from 'next/router';\nimport cookie from 'js-cookie';\nimport { parseCookies } from 'nookies';\n\n// handle auto login when created an account, and login\nfunction autoLogin(token, location) {\n  cookie.set('token', token);\n  Router.push(location);\n}\n\nfunction redirectUser(ctx, location) {\n  if (ctx.req) {\n    ctx.res.writeHead(302, { Location: location });\n    ctx.res.end();\n  } else {\n    Router.push('location');\n  }\n}\n\nfunction checkToken(ctx) {\n  if (ctx.req) {\n    const { token } = parseCookies(ctx);\n    if (!token) redirectUser(ctx, '/');\n  } else {\n  }\n}\n\nexport { autoLogin, redirectUser, checkToken };\n"]},"metadata":{},"sourceType":"module"}