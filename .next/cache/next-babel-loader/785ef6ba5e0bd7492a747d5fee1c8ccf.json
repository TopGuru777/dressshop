{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nvar _jsxFileName = \"/home/russ/projects/dress-shop/pages/cart.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from 'react';\nimport Layout from '../components/Layout';\nimport { useAuth } from '../store/auth/auth.context';\nimport { useCart } from '../store/cart/cart.context';\nimport cookie from 'js-cookie';\nimport StripeCheckout from 'react-stripe-checkout';\nimport CartList from '../components/Cart/CartList';\nimport CartSubTotal from '../components/Cart/CartSubTotal';\nimport calculateCartTotal from '../utils/calculateCartTotal';\nimport Link from 'next/link';\nimport axios from 'axios';\nimport baseURL from '../utils/baseURL';\nimport Spinner from '../components/Shared/Loader/Spinner';\nimport Router from 'next/router';\nimport SkeletonCart from '../components/Shared/Loader/SkeletonCart';\n\nvar Cart = function Cart() {\n  var _useAuth = useAuth(),\n      currentUser = _useAuth.currentUser;\n\n  var _useCart = useCart(),\n      carts = _useCart.carts,\n      removeCart = _useCart.removeCart,\n      clearCart = _useCart.clearCart,\n      loading = _useCart.loading;\n\n  var _calculateCartTotal = calculateCartTotal(carts),\n      cartTotal = _calculateCartTotal.cartTotal,\n      stripeTotal = _calculateCartTotal.stripeTotal;\n\n  var _useState = useState(false),\n      submitting = _useState[0],\n      setSubmitting = _useState[1];\n\n  var _useState2 = useState(false),\n      success = _useState2[0],\n      setSuccess = _useState2[1];\n\n  useEffect(function () {\n    // clear cart on mount, if checkout successfully\n    return function () {\n      if (success) {\n        clearCart();\n      }\n    };\n  }, [success]);\n\n  var handleCheckout = function handleCheckout(paymentData) {\n    var token, payload, headers;\n    return _regeneratorRuntime.async(function handleCheckout$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            setSubmitting(true);\n            token = cookie.get('token');\n            payload = {\n              paymentData: paymentData\n            };\n            headers = {\n              headers: {\n                Authorization: token\n              }\n            };\n            _context.next = 7;\n            return _regeneratorRuntime.awrap(axios.post(\"\".concat(baseURL, \"/api/checkout\"), payload, headers));\n\n          case 7:\n            setSuccess(true);\n            setSubmitting(false);\n            Router.push('/order');\n            _context.next = 15;\n            break;\n\n          case 12:\n            _context.prev = 12;\n            _context.t0 = _context[\"catch\"](0);\n            console.log(_context.t0);\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 12]]);\n  };\n\n  return __jsx(Layout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-589478059\" + \" \" + \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  }, currentUser ? __jsx(\"div\", {\n    className: \"jsx-589478059\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: \"jsx-589478059\" + \" \" + \"page-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, \"Your Cart\"), loading ? __jsx(SkeletonCart, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }) : __jsx(React.Fragment, null, carts.length > 0 ? __jsx(React.Fragment, null, __jsx(CartList, {\n    carts: carts,\n    removeCart: removeCart,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }), __jsx(CartSubTotal, {\n    total: Number(cartTotal),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }), __jsx(StripeCheckout, {\n    name: \"Dress Shop\",\n    amount: stripeTotal,\n    currency: \"PHP\",\n    shippingAddress: true,\n    billingAddress: true,\n    zipCode: true,\n    stripeKey: \"pk_test_hsm6fyMNxWvCWNRY58tIAXAw006jqf8Kzt\",\n    token: handleCheckout,\n    triggerEvent: \"onClick\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-589478059\" + \" \" + \"checkout-btn-wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, __jsx(\"button\", {\n    disabled: submitting,\n    className: \"jsx-589478059\" + \" \" + \"checkout-btn\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, ' ', submitting ? __jsx(Spinner, {\n    color: \"#fff\",\n    width: 40,\n    height: 40,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }) : 'CHECK OUT', ' ')))) : __jsx(\"div\", {\n    className: \"jsx-589478059\" + \" \" + \"msg-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"jsx-589478059\" + \" \" + \"msg\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, \" Your cart is empty :( \"), __jsx(Link, {\n    href: \"/\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, __jsx(\"a\", {\n    className: \"jsx-589478059\" + \" \" + \"btn\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, \" Go Shop Now \"))))) : __jsx(\"div\", {\n    className: \"jsx-589478059\" + \" \" + \"msg-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: \"jsx-589478059\" + \" \" + \"page-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, \" Please login to see your cart \"), __jsx(Link, {\n    href: \"/login\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, __jsx(\"a\", {\n    className: \"jsx-589478059\" + \" \" + \"btn\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, \" Login \")))), __jsx(_JSXStyle, {\n    id: \"589478059\",\n    __self: this\n  }, \".container.jsx-589478059{max-width:1200px;margin:2rem auto;}.page-title.jsx-589478059{font-size:3rem;}.checkout-btn-wrapper.jsx-589478059{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.checkout-btn.jsx-589478059,.btn.jsx-589478059{width:20rem;color:#fff;background-color:var(--color-dark);border:1px solid var(--color-dark);height:6rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;font-size:1.8rem;cursor:pointer;}.btn.jsx-589478059{margin:5rem 0;}.msg.jsx-589478059{font-size:2.2rem;}.msg-container.jsx-589478059{padding:2rem 0;text-align:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3J1c3MvcHJvamVjdHMvZHJlc3Mtc2hvcC9wYWdlcy9jYXJ0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQXlHUyxBQUc4QixBQUtGLEFBSUYsQUFPRCxBQWFFLEFBSUcsQUFJRixZQXBCSixFQWFiLENBeEJBLEFBZ0NvQixFQXJDRCxBQWlDbkIsTUFoQnFDLFVBcUJ0QixDQXJDZix3QkFpQnFDLGdCQVRWLG1CQVViLFlBQ0MsRUFtQlMsZ0VBN0JILFFBV0EsTUFtQkEsK0VBN0JyQixRQVd5QixNQW1CQSw2RkFsQk4sTUFtQm5CLFdBbEJpQixlQUNqQiIsImZpbGUiOiIvaG9tZS9ydXNzL3Byb2plY3RzL2RyZXNzLXNob3AvcGFnZXMvY2FydC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgTGF5b3V0IGZyb20gJy4uL2NvbXBvbmVudHMvTGF5b3V0JztcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICcuLi9zdG9yZS9hdXRoL2F1dGguY29udGV4dCc7XG5pbXBvcnQgeyB1c2VDYXJ0IH0gZnJvbSAnLi4vc3RvcmUvY2FydC9jYXJ0LmNvbnRleHQnO1xuaW1wb3J0IGNvb2tpZSBmcm9tICdqcy1jb29raWUnO1xuaW1wb3J0IFN0cmlwZUNoZWNrb3V0IGZyb20gJ3JlYWN0LXN0cmlwZS1jaGVja291dCc7XG5pbXBvcnQgQ2FydExpc3QgZnJvbSAnLi4vY29tcG9uZW50cy9DYXJ0L0NhcnRMaXN0JztcbmltcG9ydCBDYXJ0U3ViVG90YWwgZnJvbSAnLi4vY29tcG9uZW50cy9DYXJ0L0NhcnRTdWJUb3RhbCc7XG5pbXBvcnQgY2FsY3VsYXRlQ2FydFRvdGFsIGZyb20gJy4uL3V0aWxzL2NhbGN1bGF0ZUNhcnRUb3RhbCc7XG5pbXBvcnQgTGluayBmcm9tICduZXh0L2xpbmsnO1xuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcbmltcG9ydCBiYXNlVVJMIGZyb20gJy4uL3V0aWxzL2Jhc2VVUkwnO1xuaW1wb3J0IFNwaW5uZXIgZnJvbSAnLi4vY29tcG9uZW50cy9TaGFyZWQvTG9hZGVyL1NwaW5uZXInO1xuaW1wb3J0IFJvdXRlciBmcm9tICduZXh0L3JvdXRlcic7XG5pbXBvcnQgU2tlbGV0b25DYXJ0IGZyb20gJy4uL2NvbXBvbmVudHMvU2hhcmVkL0xvYWRlci9Ta2VsZXRvbkNhcnQnO1xuXG5jb25zdCBDYXJ0ID0gKCkgPT4ge1xuICBjb25zdCB7IGN1cnJlbnRVc2VyIH0gPSB1c2VBdXRoKCk7XG4gIGNvbnN0IHsgY2FydHMsIHJlbW92ZUNhcnQsIGNsZWFyQ2FydCwgbG9hZGluZyB9ID0gdXNlQ2FydCgpO1xuICBjb25zdCB7IGNhcnRUb3RhbCwgc3RyaXBlVG90YWwgfSA9IGNhbGN1bGF0ZUNhcnRUb3RhbChjYXJ0cyk7XG4gIGNvbnN0IFtzdWJtaXR0aW5nLCBzZXRTdWJtaXR0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3N1Y2Nlc3MsIHNldFN1Y2Nlc3NdID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gY2xlYXIgY2FydCBvbiBtb3VudCwgaWYgY2hlY2tvdXQgc3VjY2Vzc2Z1bGx5XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICAgIGNsZWFyQ2FydCgpO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtzdWNjZXNzXSk7XG5cbiAgY29uc3QgaGFuZGxlQ2hlY2tvdXQgPSBhc3luYyBwYXltZW50RGF0YSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIHNldFN1Ym1pdHRpbmcodHJ1ZSk7XG4gICAgICBjb25zdCB0b2tlbiA9IGNvb2tpZS5nZXQoJ3Rva2VuJyk7XG4gICAgICBjb25zdCBwYXlsb2FkID0geyBwYXltZW50RGF0YSB9O1xuICAgICAgY29uc3QgaGVhZGVycyA9IHsgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiB0b2tlbiB9IH07XG4gICAgICBhd2FpdCBheGlvcy5wb3N0KGAke2Jhc2VVUkx9L2FwaS9jaGVja291dGAsIHBheWxvYWQsIGhlYWRlcnMpO1xuICAgICAgc2V0U3VjY2Vzcyh0cnVlKTtcbiAgICAgIHNldFN1Ym1pdHRpbmcoZmFsc2UpO1xuICAgICAgUm91dGVyLnB1c2goJy9vcmRlcicpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPExheW91dD5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGFpbmVyXCI+XG4gICAgICAgIHtjdXJyZW50VXNlciA/IChcbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPGgxIGNsYXNzTmFtZT1cInBhZ2UtdGl0bGVcIj5Zb3VyIENhcnQ8L2gxPlxuICAgICAgICAgICAge2xvYWRpbmcgPyAoXG4gICAgICAgICAgICAgIDxTa2VsZXRvbkNhcnQgLz5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAge2NhcnRzLmxlbmd0aCA+IDAgPyAoXG4gICAgICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgICAgICA8Q2FydExpc3QgY2FydHM9e2NhcnRzfSByZW1vdmVDYXJ0PXtyZW1vdmVDYXJ0fSAvPlxuICAgICAgICAgICAgICAgICAgICA8Q2FydFN1YlRvdGFsIHRvdGFsPXtOdW1iZXIoY2FydFRvdGFsKX0gLz5cbiAgICAgICAgICAgICAgICAgICAgPFN0cmlwZUNoZWNrb3V0XG4gICAgICAgICAgICAgICAgICAgICAgbmFtZT1cIkRyZXNzIFNob3BcIlxuICAgICAgICAgICAgICAgICAgICAgIGFtb3VudD17c3RyaXBlVG90YWx9XG4gICAgICAgICAgICAgICAgICAgICAgY3VycmVuY3k9XCJQSFBcIlxuICAgICAgICAgICAgICAgICAgICAgIHNoaXBwaW5nQWRkcmVzcz17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICBiaWxsaW5nQWRkcmVzcz17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICB6aXBDb2RlPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgIHN0cmlwZUtleT1cInBrX3Rlc3RfaHNtNmZ5TU54V3ZDV05SWTU4dElBWEF3MDA2anFmOEt6dFwiXG4gICAgICAgICAgICAgICAgICAgICAgdG9rZW49e2hhbmRsZUNoZWNrb3V0fVxuICAgICAgICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudD1cIm9uQ2xpY2tcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjaGVja291dC1idG4td3JhcHBlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJjaGVja291dC1idG5cIiBkaXNhYmxlZD17c3VibWl0dGluZ30+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHsnICd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtzdWJtaXR0aW5nID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTcGlubmVyIGNvbG9yPVwiI2ZmZlwiIHdpZHRoPXs0MH0gaGVpZ2h0PXs0MH0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ0hFQ0sgT1VUJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICApfXsnICd9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9TdHJpcGVDaGVja291dD5cbiAgICAgICAgICAgICAgICAgIDwvPlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1zZy1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtc2dcIj4gWW91ciBjYXJ0IGlzIGVtcHR5IDooIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8TGluayBocmVmPVwiL1wiPlxuICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT1cImJ0blwiPiBHbyBTaG9wIE5vdyA8L2E+XG4gICAgICAgICAgICAgICAgICAgIDwvTGluaz5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDwvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1zZy1jb250YWluZXJcIj5cbiAgICAgICAgICAgIDxoMSBjbGFzc05hbWU9XCJwYWdlLXRpdGxlXCI+IFBsZWFzZSBsb2dpbiB0byBzZWUgeW91ciBjYXJ0IDwvaDE+XG4gICAgICAgICAgICA8TGluayBocmVmPVwiL2xvZ2luXCI+XG4gICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT1cImJ0blwiPiBMb2dpbiA8L2E+XG4gICAgICAgICAgICA8L0xpbms+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICl9XG4gICAgICA8L2Rpdj5cbiAgICAgIDxzdHlsZSBqc3g+XG4gICAgICAgIHtgXG4gICAgICAgICAgLmNvbnRhaW5lciB7XG4gICAgICAgICAgICBtYXgtd2lkdGg6IDEyMDBweDtcbiAgICAgICAgICAgIG1hcmdpbjogMnJlbSBhdXRvO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC5wYWdlLXRpdGxlIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogM3JlbTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAuY2hlY2tvdXQtYnRuLXdyYXBwZXIge1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC5jaGVja291dC1idG4sXG4gICAgICAgICAgLmJ0biB7XG4gICAgICAgICAgICB3aWR0aDogMjByZW07XG4gICAgICAgICAgICBjb2xvcjogI2ZmZjtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWNvbG9yLWRhcmspO1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tY29sb3ItZGFyayk7XG4gICAgICAgICAgICBoZWlnaHQ6IDZyZW07XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgICAgZm9udC1zaXplOiAxLjhyZW07XG4gICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLmJ0biB7XG4gICAgICAgICAgICBtYXJnaW46IDVyZW0gMDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAubXNnIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMi4ycmVtO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC5tc2ctY29udGFpbmVyIHtcbiAgICAgICAgICAgIHBhZGRpbmc6IDJyZW0gMDtcbiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgIH1cbiAgICAgICAgYH1cbiAgICAgIDwvc3R5bGU+XG4gICAgPC9MYXlvdXQ+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBDYXJ0O1xuIl19 */\\n/*@ sourceURL=/home/russ/projects/dress-shop/pages/cart.js */\"));\n};\n\nexport default Cart;","map":{"version":3,"sources":["/home/russ/projects/dress-shop/pages/cart.js"],"names":["useState","useEffect","Layout","useAuth","useCart","cookie","StripeCheckout","CartList","CartSubTotal","calculateCartTotal","Link","axios","baseURL","Spinner","Router","SkeletonCart","Cart","currentUser","carts","removeCart","clearCart","loading","cartTotal","stripeTotal","submitting","setSubmitting","success","setSuccess","handleCheckout","paymentData","token","get","payload","headers","Authorization","post","push","console","log","length","Number"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport Layout from '../components/Layout';\nimport { useAuth } from '../store/auth/auth.context';\nimport { useCart } from '../store/cart/cart.context';\nimport cookie from 'js-cookie';\nimport StripeCheckout from 'react-stripe-checkout';\nimport CartList from '../components/Cart/CartList';\nimport CartSubTotal from '../components/Cart/CartSubTotal';\nimport calculateCartTotal from '../utils/calculateCartTotal';\nimport Link from 'next/link';\nimport axios from 'axios';\nimport baseURL from '../utils/baseURL';\nimport Spinner from '../components/Shared/Loader/Spinner';\nimport Router from 'next/router';\nimport SkeletonCart from '../components/Shared/Loader/SkeletonCart';\n\nconst Cart = () => {\n  const { currentUser } = useAuth();\n  const { carts, removeCart, clearCart, loading } = useCart();\n  const { cartTotal, stripeTotal } = calculateCartTotal(carts);\n  const [submitting, setSubmitting] = useState(false);\n  const [success, setSuccess] = useState(false);\n\n  useEffect(() => {\n    // clear cart on mount, if checkout successfully\n    return () => {\n      if (success) {\n        clearCart();\n      }\n    };\n  }, [success]);\n\n  const handleCheckout = async paymentData => {\n    try {\n      setSubmitting(true);\n      const token = cookie.get('token');\n      const payload = { paymentData };\n      const headers = { headers: { Authorization: token } };\n      await axios.post(`${baseURL}/api/checkout`, payload, headers);\n      setSuccess(true);\n      setSubmitting(false);\n      Router.push('/order');\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return (\n    <Layout>\n      <div className=\"container\">\n        {currentUser ? (\n          <div>\n            <h1 className=\"page-title\">Your Cart</h1>\n            {loading ? (\n              <SkeletonCart />\n            ) : (\n              <>\n                {carts.length > 0 ? (\n                  <>\n                    <CartList carts={carts} removeCart={removeCart} />\n                    <CartSubTotal total={Number(cartTotal)} />\n                    <StripeCheckout\n                      name=\"Dress Shop\"\n                      amount={stripeTotal}\n                      currency=\"PHP\"\n                      shippingAddress={true}\n                      billingAddress={true}\n                      zipCode={true}\n                      stripeKey=\"pk_test_hsm6fyMNxWvCWNRY58tIAXAw006jqf8Kzt\"\n                      token={handleCheckout}\n                      triggerEvent=\"onClick\"\n                    >\n                      <div className=\"checkout-btn-wrapper\">\n                        <button className=\"checkout-btn\" disabled={submitting}>\n                          {' '}\n                          {submitting ? (\n                            <Spinner color=\"#fff\" width={40} height={40} />\n                          ) : (\n                            'CHECK OUT'\n                          )}{' '}\n                        </button>\n                      </div>\n                    </StripeCheckout>\n                  </>\n                ) : (\n                  <div className=\"msg-container\">\n                    <div className=\"msg\"> Your cart is empty :( </div>\n                    <Link href=\"/\">\n                      <a className=\"btn\"> Go Shop Now </a>\n                    </Link>\n                  </div>\n                )}\n              </>\n            )}\n          </div>\n        ) : (\n          <div className=\"msg-container\">\n            <h1 className=\"page-title\"> Please login to see your cart </h1>\n            <Link href=\"/login\">\n              <a className=\"btn\"> Login </a>\n            </Link>\n          </div>\n        )}\n      </div>\n      <style jsx>\n        {`\n          .container {\n            max-width: 1200px;\n            margin: 2rem auto;\n          }\n\n          .page-title {\n            font-size: 3rem;\n          }\n\n          .checkout-btn-wrapper {\n            display: flex;\n            justify-content: flex-end;\n            align-items: center;\n          }\n\n          .checkout-btn,\n          .btn {\n            width: 20rem;\n            color: #fff;\n            background-color: var(--color-dark);\n            border: 1px solid var(--color-dark);\n            height: 6rem;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 1.8rem;\n            cursor: pointer;\n          }\n\n          .btn {\n            margin: 5rem 0;\n          }\n\n          .msg {\n            font-size: 2.2rem;\n          }\n\n          .msg-container {\n            padding: 2rem 0;\n            text-align: center;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n          }\n        `}\n      </style>\n    </Layout>\n  );\n};\n\nexport default Cart;\n"]},"metadata":{},"sourceType":"module"}