{"ast":null,"code":"import connectDB from '../../utils/connectDB';\nimport Product from '../../models/Product';\nexport default (async (req, res) => {\n  await connectDB();\n\n  try {\n    let {\n      category,\n      price,\n      keyword\n    } = req.query;\n    let products = [];\n    let sort;\n\n    if (keyword) {\n      if (price) {\n        sort = price === 'low' ? 1 : -1;\n        products = await Product.find({\n          $text: {\n            $search: keyword\n          }\n        }).sort({\n          price: sort\n        });\n      } else {\n        products = await Product.find({\n          $text: {\n            $search: keyword\n          }\n        });\n      }\n    } else if (category) {\n      products = await Product.find({\n        category\n      });\n    }\n\n    console.log(products); // if (price) {\n    //   if (price === 'low') {\n    //     sort = 1;\n    //   } else {\n    //     sort = -1;\n    //   }\n    //   products = await Product.find({ category }).sort({ price: sort });\n    // } else {\n    //   products = await Product.find({ category });\n    // }\n\n    res.status(200).json({\n      products\n    });\n  } catch (error) {\n    console.error(error);\n    res.status(500).send('Error in getting categories');\n  }\n});","map":{"version":3,"sources":["/home/russ/projects/dress-shop/pages/api/category.js"],"names":["connectDB","Product","req","res","category","price","keyword","query","products","sort","find","$text","$search","console","log","status","json","error","send"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,uBAAtB;AACA,OAAOC,OAAP,MAAoB,sBAApB;AAEA,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjC,QAAMH,SAAS,EAAf;;AACA,MAAI;AACF,QAAI;AAAEI,MAAAA,QAAF;AAAYC,MAAAA,KAAZ;AAAmBC,MAAAA;AAAnB,QAA+BJ,GAAG,CAACK,KAAvC;AAEA,QAAIC,QAAQ,GAAG,EAAf;AACA,QAAIC,IAAJ;;AACA,QAAIH,OAAJ,EAAa;AACX,UAAID,KAAJ,EAAW;AACTI,QAAAA,IAAI,GAAGJ,KAAK,KAAK,KAAV,GAAkB,CAAlB,GAAsB,CAAC,CAA9B;AACAG,QAAAA,QAAQ,GAAG,MAAMP,OAAO,CAACS,IAAR,CAAa;AAAEC,UAAAA,KAAK,EAAE;AAAEC,YAAAA,OAAO,EAAEN;AAAX;AAAT,SAAb,EAA8CG,IAA9C,CAAmD;AAClEJ,UAAAA,KAAK,EAAEI;AAD2D,SAAnD,CAAjB;AAGD,OALD,MAKO;AACLD,QAAAA,QAAQ,GAAG,MAAMP,OAAO,CAACS,IAAR,CAAa;AAAEC,UAAAA,KAAK,EAAE;AAAEC,YAAAA,OAAO,EAAEN;AAAX;AAAT,SAAb,CAAjB;AACD;AACF,KATD,MASO,IAAIF,QAAJ,EAAc;AACnBI,MAAAA,QAAQ,GAAG,MAAMP,OAAO,CAACS,IAAR,CAAa;AAAEN,QAAAA;AAAF,OAAb,CAAjB;AACD;;AAEDS,IAAAA,OAAO,CAACC,GAAR,CAAYN,QAAZ,EAlBE,CAoBF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAL,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAER,MAAAA;AAAF,KAArB;AACD,GA/BD,CA+BE,OAAOS,KAAP,EAAc;AACdJ,IAAAA,OAAO,CAACI,KAAR,CAAcA,KAAd;AACAd,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBG,IAAhB,CAAqB,6BAArB;AACD;AACF,CArCD","sourcesContent":["import connectDB from '../../utils/connectDB';\nimport Product from '../../models/Product';\n\nexport default async (req, res) => {\n  await connectDB();\n  try {\n    let { category, price, keyword } = req.query;\n\n    let products = [];\n    let sort;\n    if (keyword) {\n      if (price) {\n        sort = price === 'low' ? 1 : -1;\n        products = await Product.find({ $text: { $search: keyword } }).sort({\n          price: sort\n        });\n      } else {\n        products = await Product.find({ $text: { $search: keyword } });\n      }\n    } else if (category) {\n      products = await Product.find({ category });\n    }\n\n    console.log(products);\n\n    // if (price) {\n    //   if (price === 'low') {\n    //     sort = 1;\n    //   } else {\n    //     sort = -1;\n    //   }\n    //   products = await Product.find({ category }).sort({ price: sort });\n    // } else {\n    //   products = await Product.find({ category });\n    // }\n    res.status(200).json({ products });\n  } catch (error) {\n    console.error(error);\n    res.status(500).send('Error in getting categories');\n  }\n};\n"]},"metadata":{},"sourceType":"module"}